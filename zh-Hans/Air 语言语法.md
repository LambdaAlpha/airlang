# Air 语言语法

## 目标

- 语法和语义解耦
- 高可读性
- 无歧义
- 规则简单，容易理解
- 线性解析时间
- 具有有限且可控的拓展性

## 设计

- 只表达必要的语义无关的信息，尽可能将计算推迟到语义解释阶段
- 上下文无关，正则语言 + 递归
- 定义通用的递归字面量，限制递归语法的使用
- 允许向前看一个字符
- 用树字面量表达上下文无关文法
- 一次只解析一个字面量
- 保留一个词法前缀以便将来拓展

## 字面量

### 原子字面量

[原子字面量语法](./Air%20语言语法/原子字面量语法.md)

### 复合字面量

[复合字面量语法](./Air%20语言语法/复合字面量语法.md)

## 非字面量

### 空白符

`[ \t\r\n]+`

空白符用于分隔非自然定界的词汇。

### 注释

`comment # value`

`comment` 和 `value` 为任意字面量。`comment # value` 被解析为 `value`。

注释用于表达语义无关的信息，。

示例：

```air
a # 1
"this is a comment" # '
1 # 2
(a[]) # '
```

### 封装

`(a)`

‌`a‌` 为任意字面量。

`(a)` 被解析为 `a`。封装是一种特征定界符，封装内外的语法解析彼此独立，封装外部的语法解析不依赖封装内部的语法特征。封装用于辅助语法解析。

示例：

```air
(a) === a
(a b) === a b
(a # b) === b
(a b) : c === (a b) : c
a (b : c) === a (b : c)
a b c === b (a : c)
a b [] === b (a : [])
(a b) [] === (a b) []
a (b c d) e === (c (b : d))(a : e)
a [] b === [] (a : b)
```

## 结合规则

- 定界符 `()`，`{}`，`[]` 内外不可结合。
- 中缀形式左结合。
- 中缀形式（如注释，配对，逆运算，中缀应用）和前缀形式（如应用）嵌套使用时，必须使用 `()` 消除歧义。例如：
  - `(a b) : c`
  - `a : (b c)`
  - `(a b) ? c`
  - `a ? (b c)`
  - `(a b) + c`
  - `a + (b c)`
  - `a (b : c)`
  - `a (b ? c)`
  - `a (b + c)`
  - `(a : b) c`
  - `(a ? b) c`
  - `(a + b) c`

## 兼容性

- 向前：所有以 `[A-Za-z]` 开头的符号串的带前缀形式都被保留为关键字，如 `'add`
- 向后：保证兼容性

## 参考

[语法参考](./Air%20语言语法/语法参考.md)
