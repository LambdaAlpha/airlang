# Air 语言语法

## 目标

- 语法和语义解耦
- 强表达能力
- 高可读性
- 无歧义
- 规则简单，容易理解
- 线性解析时间
- 具有有限且可控的拓展性

## 设计

- 只表达必要的语义无关的信息，尽可能将计算推迟到语义解释阶段
- 使用调用和逆向表达任何语义
- 上下文无关，正则语言 + 递归
- 定义通用的递归字面量，限制递归语法的使用，替代任何上下文无关文法
- 允许向前看一个字符
- 一次只解析一个字面量
- 保留一个无限的符号集合以便将来拓展

## 语法规范

### 单个参数

使用形如 `a b` 的前缀形式，其中 `a` 是保留关键字。

### 两个参数

使用形如 `a b c` 的中缀形式，其中 `b` 是保留关键字。

### 三个或以上参数

使用形如 `a [b, c, d, ...]` 或 `a {b : c, d : e, f : g, ...}` 的前缀形式，其中 `a` 是保留关键字。

## 结合规则

- 定界符 `()`，`{}`，`[]` 内外不可结合，`,` 左右不可结合。
- 中缀形式和前缀形式嵌套使用时，必须使用 `()` 消除歧义。例如：
  - `(a b) : c`
  - `a : (b c)`
  - `(a b) ? c`
  - `a ? (b c)`
  - `(a b) + c`
  - `a + (b c)`
  - `a (b : c)`
  - `a (b ? c)`
  - `a (b + c)`
  - `(a : b) c`
  - `(a ? b) c`
  - `(a + b) c`
- 因此只有中缀形式需要考虑结合规则，而中缀形式只有一条结合规则：左结合。

## 简写形式

- `a $ b` 可以简写为 `a b`
- `b $ (a : c)` 可以简写为 `a b c`
- 形如 `a b c` 的中缀形式，其中 `b` 是保留关键字。若 `a` 和 `c` 相同，则可以简写为 `b c` 形式。例如：
  - `@ a` === `a @ a`
  - `: a` === `a : a`
  - `$ a` === `a $ a`
  - `? a` === `a ? a`
  - `{: a}` === `{a : a}`
- 在映射中，如果键值对中的值为 `'`，则可以简写，比如 `{a : ', b : c}` 可以简写为 `{a, b : c}`

## 兼容性

- 向前：所有以 `[A-Za-z]` 开头的符号的带前缀形式都被保留为关键字，如 `'auto`。
- 向后：保证兼容性

## 字面量

### 原子字面量

[原子字面量语法](./Air%20语言语法/原子字面量语法.md)

### 复合字面量

[复合字面量语法](./Air%20语言语法/复合字面量语法.md)

## 非字面量

### 空白符

`[ \t\r\n]+`

词汇之间必须使用空白符隔开，除非其中一个词汇是语法特征词汇（`()[]{},`）。

### 注释

`comment @ value`

`comment` 和 `value` 为任意字面量。`comment @ value` 被解析为 `value`。

注释用于表达语义无关的信息。

示例：

```air
a @ 1
"this is a comment" @ '
1 @ 2
(a[]) @ '
```

### 括号

`(a)`

‌`a‌` 为任意字面量。

`(a)` 被解析为 `a`。括号是一种定界符，括号内外的语法解析彼此独立，括号外部的语法解析不依赖括号内部的语法特征。括号用于增强可读性和辅助语法解析。

示例：

```air
(a) === a
(a b) === a b
(a @ b) === b
(a b) : c === (a b) : c
a (b : c) === a (b : c)
a b c === b (a : c)
a b [] === b (a : [])
(a b) [] === (a b) []
a (b c d) e === (c (b : d))(a : e)
a [] b === [] (a : b)
```

## 参考

[语法参考](./Air%20语言语法/语法参考.md)
