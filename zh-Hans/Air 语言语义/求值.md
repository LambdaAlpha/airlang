# 求值

求值规则基于输入的类型

## 符号

- `.a` 表示 `a`
- `$a` 表示读取上下文中 `a` 的值
- `&a` 表示移动上下文中 `a` 的值

## 调用

调用 `f i`：先对 `f` 求值，得到 `f1`

### 对输入求值并调用

- 若 `f1` 是一个函数，则根据 `f1` 的调用模式对 `i` 求值，得到 `i1`，然后以当前上下文和输入 `i1` 调用函数 `f1`，并返回其返回值
- 否则对 `i` 求值，得到 `i1`，返回 `f1 i1`

## 询问

询问 `f ? o`：先对 `f` 求值，得到 `f1`

### 对输出求值并询问

- 若 `f1` 是一个函数，则根据 `f1` 的询问模式对 `o` 求值，得到 `o1`
  - 若当前上下文有求解器 `s`，则以输入 `f1 ? o1` 调用 `s`，得到 `a`
    - 若 `a` 是答案
      - 若 `a` 是 `answer.cache(c)`，
        - 若 `c` 的函数和 `f1` 相等，且 `c` 的输出和 `o1` 相等，则返回 `a`
        - 否则返回 `answer.none`
      - 否则返回 `a`
    - 否则返回 `answer.none`
  - 否则返回 `answer.none`
- 否则对 `o` 求值，得到 `o1`，返回 `f1 ? o1`

## 注释

注释 `m ; v`：对 `v` 求值，得到 `v1`，返回 `v1`

## 复合值

递归调用，具体如下

- 配对 `a : b`：分别对 `a`，`b` 求值，得到 `a1`，`b1`，返回 `a1 : b1`
- 列表：对列表中的每个元素求值，返回对应列表
- 映射：对映射中的每个键值对求值，返回对应映射

## 其他值

保持不变
