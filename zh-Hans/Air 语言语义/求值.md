# 求值

设任务的函数为 `f`，上下文为 `ctx`，输入为 `i`

## 调用

- 对 `f` 求值，得到 `f1`
- 若 `f1` 是一个函数
  - 根据 `f1` 的调用设置对 `ctx` 求值，得到 `ctx1`
  - 根据 `f1` 的调用设置对 `i` 求值，得到 `i1`
  - 若 `ctx1` 为单元，则使用当前上下文
  - 若 `ctx1` 为符号，则切换上下文为当前上下文中符号 `ctx1` 所绑定的值
  - 以当前上下文和输入 `i1` 调用函数 `f1`，并返回其返回值
- 若 `f1` 是一个符号，其在上下文中绑定的函数为 `f2`
  - 将上下文中 `f1` 绑定设为不可访问
  - 根据 `f2` 的调用设置对 `ctx` 求值，得到 `ctx1`
  - 根据 `f2` 的调用设置对 `i` 求值，得到 `i1`
  - 若 `ctx1` 为单元，则使用当前上下文
  - 若 `ctx1` 为符号，则切换上下文为当前上下文中符号 `ctx1` 所绑定的值
  - 以当前上下文和输入 `i1` 调用函数 `f2`，得到 `o`
  - 将上下文中 `f1` 绑定设为可访问
  - 返回 `o`
- 否则返回单元

## 求解

- 对 `f` 求值，得到 `f1`
- 若 `f1` 是一个函数
  - 根据 `f1` 的求解设置对 `ctx` 求值，得到 `ctx1`
  - 根据 `f1` 的求解设置对 `i` 求值，得到 `i1`
  - 若 `ctx1` 为单元，则使用当前上下文
  - 若 `ctx1` 为符号，则切换上下文为当前上下文中符号 `ctx1` 所绑定的值
  - 若注册了 `f1` 的逆函数 `g`，则以当前上下文和 `i1` 调用 `g`，并返回其返回值
  - 否则若存在求解器，以当前上下文和输入 `f1 : i1` 调用求解器 `s`，并返回其返回值
- 若 `f1` 是一个符号，其在上下文中绑定的函数为 `f2`
  - 将上下文中 `f1` 绑定设为不可访问
  - 根据 `f2` 的求解设置对 `ctx` 求值，得到 `ctx1`
  - 根据 `f2` 的求解设置对 `i` 求值，得到 `i1`
  - 若 `ctx1` 为单元，则使用当前上下文
  - 若 `ctx1` 为符号，则切换上下文为当前上下文中符号 `ctx1` 所绑定的值
  - 若注册了 `f2` 的逆函数 `g`，则以当前上下文和 `i1` 调用 `g`，得到 `o`
  - 否则若存在求解器，以当前上下文和输入 `f2 : i1` 调用求解器 `s`，得到 `o`
  - 否则设 `o` 为单元
  - 将上下文中 `f1` 绑定设为可访问
  - 返回 `o`
- 否则返回单元
